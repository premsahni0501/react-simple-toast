{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { createContext, useReducer, useContext, useEffect } from 'react';\nimport style from './Toaster.scss'\n\nconst ToastStateContext = createContext();\nconst ToastDispatchContext = createContext();\n\nfunction ToastReducer(state, action) {\n  switch (action.type) {\n    case 'show': {\n      console.log(action);\n      return {\n        messages: [...state.messages, action.toast],\n      }\n    }\n    case 'remove': {\n      const { messages } = state;\n      const found = messages.filter(m => m.timestamp === action.timestamp);\n      const filtered = messages.filter(m => m.timestamp !== action.timestamp);\n      if (found.length) {\n        const toast = found[0];\n        clearTimeout(toast.timer());\n      }\n      return {\n        messages: [...filtered]\n      }\n    }\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`)\n    }\n  }\n}\nfunction ToastProvider({ children }) {\n  const [state, dispatch] = useReducer(ToastReducer, { messages: [] });\n  return (\n    <ToastStateContext.Provider value={state}>\n      <ToastDispatchContext.Provider value={dispatch}>\n        <ToastConsumer>{children}</ToastConsumer>\n      </ToastDispatchContext.Provider>\n    </ToastStateContext.Provider>\n  )\n}\n\nfunction useToastState() {\n  const context = useContext(ToastStateContext);\n  if (context === undefined) {\n    throw new Error('useToastState must be used within a ToastProvider')\n  }\n  return context\n}\nfunction useToastDispatch() {\n  const context = useContext(ToastDispatchContext);\n  if (context === undefined) {\n    throw new Error('useToastDispatch must be used within a ToastProvider')\n  }\n  return context\n}\nfunction useToastShow() {\n  const dispatch = useToastDispatch();\n\n  return (msg, timeout, theme, className, customStyle) => {\n    if (!msg) return;\n    const timestamp = Date.now();\n    const removeTimeout = () => setTimeout(() => {\n      dispatch({ type: 'remove', timestamp });\n    }, timeout || 5000);\n    const toastObj = {\n      type: 'show',\n      toast: {\n        msg,\n        timer() {\n          return removeTimeout();\n        },\n        timestamp,\n        theme,\n        customStyle,\n        className\n      },\n    }\n    dispatch(toastObj);\n    removeTimeout()\n  }\n}\nfunction ToastConsumer({ children }) {\n  const state = useToastState()\n  console.log(state)\n  useEffect(() => {\n    const firstChildEl = document.querySelector('.toast-wrapper');\n    if (firstChildEl && firstChildEl.lastChild) {\n      firstChildEl.lastChild.scrollIntoView({\n        behavior: 'smooth'\n      })\n    }\n  }, [state])\n  return (\n    <ToastStateContext.Consumer>\n      {\n        context => {\n          if (context === undefined) {\n            throw new Error('ToastConsumer must be used within a ToastProvider')\n          }\n          const { messages } = context;\n          return (\n            <ToastDispatchContext.Consumer>\n              {dispatch => (\n                <div>\n                  {children}\n                  {messages.length ? (\n                    <div\n                      className={`toast-wrapper ${style['toast-wrapper']}`}>\n                      {\n                        messages.map(m => (\n                          <div\n                            className={`toast ${style['toast']}${' ' + style[m.theme] || ''}${' ' + m.className || ''}`}\n                            role=\"alert\"\n                            key={'_' + Math.random() * m.timestamp}\n                            style={m.customStyle && m.customStyle.toaster ? m.customStyle.toaster : {}}>\n                            <span>{m.msg}</span>\n                            <br></br>\n                            <button\n                              className={style['toast-btn']}\n                              onClick={() => dispatch({ type: 'remove', timestamp: m.timestamp })}\n                              style={m.customStyle && m.customStyle.button ? m.customStyle.button : {}}>\n                              &times;\n                              </button>\n                          </div>\n                        ))\n                      }\n                    </div>\n                  ) : null}\n                </div>\n              )}\n            </ToastDispatchContext.Consumer>\n          )\n        }\n      }\n    </ToastStateContext.Consumer>\n  )\n}\nfunction useToast() {\n  return [useToastState(), useToastDispatch()]\n}\n\nfunction withShowToast(WrappedComponent) {\n  return function (props) {\n    const showToast = useToastShow();\n    return <WrappedComponent {...props} showToast={showToast} />\n  }\n}\nexport { useToast, ToastProvider, ToastConsumer, useToastShow, withShowToast };"],"names":["ToastStateContext","createContext","ToastDispatchContext","ToastReducer","state","action","type","console","log","messages","toast","found","filter","m","timestamp","filtered","length","clearTimeout","timer","Error","ToastProvider","children","useReducer","dispatch","React","useToastState","context","useContext","undefined","useToastDispatch","useToastShow","msg","timeout","theme","className","customStyle","Date","now","removeTimeout","setTimeout","toastObj","ToastConsumer","useEffect","firstChildEl","document","querySelector","lastChild","scrollIntoView","behavior","style","map","Math","random","toaster","button","useToast","withShowToast","WrappedComponent","props","showToast"],"mappings":"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"}