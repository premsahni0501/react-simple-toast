{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import React, { createContext, useReducer, useContext, useEffect } from 'react';\nimport style from './Toaster.scss'\n\nconst ToastStateContext = createContext();\nconst ToastDispatchContext = createContext();\n\nfunction ToastReducer(state, action) {\n  switch (action.type) {\n    case 'show': {\n      console.log(action);\n      return {\n        messages: [...state.messages, action.toast],\n      }\n    }\n    case 'remove': {\n      const { messages } = state;\n      const found = messages.filter(m => m.timestamp === action.timestamp);\n      const filtered = messages.filter(m => m.timestamp !== action.timestamp);\n      if (found.length) {\n        const toast = found[0];\n        clearTimeout(toast.timer());\n      }\n      return {\n        messages: [...filtered]\n      }\n    }\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`)\n    }\n  }\n}\nfunction ToastProvider({ children }) {\n  const [state, dispatch] = useReducer(ToastReducer, { messages: [] });\n  return (\n    <ToastStateContext.Provider value={state}>\n      <ToastDispatchContext.Provider value={dispatch}>\n        <ToastConsumer>{children}</ToastConsumer>\n      </ToastDispatchContext.Provider>\n    </ToastStateContext.Provider>\n  )\n}\n\nfunction useToastState() {\n  const context = useContext(ToastStateContext);\n  if (context === undefined) {\n    throw new Error('useToastState must be used within a ToastProvider')\n  }\n  return context\n}\nfunction useToastDispatch() {\n  const context = useContext(ToastDispatchContext);\n  if (context === undefined) {\n    throw new Error('useToastDispatch must be used within a ToastProvider')\n  }\n  return context\n}\nfunction useToastShow() {\n  const dispatch = useToastDispatch();\n\n  return (msg, timeout, theme, className, customStyle) => {\n    if (!msg) return;\n    const timestamp = Date.now();\n    const removeTimeout = () => setTimeout(() => {\n      dispatch({ type: 'remove', timestamp });\n    }, timeout || 5000);\n    const toastObj = {\n      type: 'show',\n      toast: {\n        msg,\n        timer() {\n          return removeTimeout();\n        },\n        timestamp,\n        theme,\n        customStyle,\n        className\n      },\n    }\n    dispatch(toastObj);\n    removeTimeout()\n  }\n}\nfunction ToastConsumer({ children }) {\n  const state = useToastState()\n  console.log(state)\n  useEffect(() => {\n    const firstChildEl = document.querySelector('.toast-wrapper');\n    if (firstChildEl && firstChildEl.lastChild) {\n      firstChildEl.lastChild.scrollIntoView({\n        behavior: 'smooth'\n      })\n    }\n  }, [state])\n  return (\n    <ToastStateContext.Consumer>\n      {\n        context => {\n          if (context === undefined) {\n            throw new Error('ToastConsumer must be used within a ToastProvider')\n          }\n          const { messages } = context;\n          return (\n            <ToastDispatchContext.Consumer>\n              {dispatch => (\n                <div>\n                  {children}\n                  {messages.length ? (\n                    <div\n                      className={`toast-wrapper ${style['toast-wrapper']}`}>\n                      {\n                        messages.map(m => (\n                          <div\n                            className={`toast ${style['toast']}${' ' + style[m.theme] || ''}${' ' + m.className || ''}`}\n                            role=\"alert\"\n                            key={'_' + Math.random() * m.timestamp}\n                            style={m.customStyle && m.customStyle.toaster ? m.customStyle.toaster : {}}>\n                            <span>{m.msg}</span>\n                            <br></br>\n                            <button\n                              className={style['toast-btn']}\n                              onClick={() => dispatch({ type: 'remove', timestamp: m.timestamp })}\n                              style={m.customStyle && m.customStyle.button ? m.customStyle.button : {}}>\n                              &times;\n                              </button>\n                          </div>\n                        ))\n                      }\n                    </div>\n                  ) : null}\n                </div>\n              )}\n            </ToastDispatchContext.Consumer>\n          )\n        }\n      }\n    </ToastStateContext.Consumer>\n  )\n}\nfunction useToast() {\n  return [useToastState(), useToastDispatch()]\n}\n\nfunction withShowToast(WrappedComponent) {\n  return function (props) {\n    const showToast = useToastShow();\n    return <WrappedComponent {...props} showToast={showToast} />\n  }\n}\nexport { useToast, ToastProvider, ToastConsumer, useToastShow, withShowToast };"],"names":["ToastStateContext","createContext","ToastDispatchContext","ToastReducer","state","action","type","console","log","messages","toast","found","filter","m","timestamp","filtered","length","clearTimeout","timer","Error","ToastProvider","children","dispatch","useReducer","useToastState","context","useContext","undefined","useToastDispatch","useToastShow","msg","timeout","theme","className","customStyle","Date","now","removeTimeout","setTimeout","toastObj","ToastConsumer","useEffect","firstChildEl","document","querySelector","lastChild","scrollIntoView","behavior","style","map","Math","random","toaster","button","useToast","withShowToast","WrappedComponent","props","showToast"],"mappings":"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"}